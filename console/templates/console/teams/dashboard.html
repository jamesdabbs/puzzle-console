{% extends 'console/base.html' %}
{% load url from future %}

{% block title %}
About {{ game.name }}
{% endblock %}

{% block content %}

<div class="row">
    <div class="span8">
        <section>
            {% if game.finished %}
                <p>All puzzles are now closed. Thanks for playing!</p>
            {% else %}
                {% for item in team.timeline %}
                {% include item.timeline_template %}
                {% endfor %}
            {% endif %}
        </section>  
    </div>  
    <div class="span4">
        <form action="{% url 'solve_puzzle' %}" method="POST">
            {% csrf_token %}
            <div class="row" style="padding-top:20px">
                <div class="span1" style="text-align:right; font-size:18px; line-height:28px;">Code:</div>
                <div class="span2"><input type="text" name="code" class="span2" style="text-align:center; text-transform:uppercase" maxlength="6" /></div>
                <div class="span1"><input type="submit" class="btn btn-primary" value="&rarr;"></div>
            </div>
        </form>
        <p>
            <div class="row" style="padding-bottom:20px">
                <div class="span1" style="text-align:right; font-size:18px; line-height:28px;">Points:</div>
                <div class="span3" style="font-size:18px; line-height:28px;">{{ team.points }}</div>
            </div>
        </p>
        <div class="well" id="achievements" style="height:300px;overflow:auto">
            <h4>Recent Activity</h4>
            {% for a in team.recent_activity %}
            <hr>
            <p>{{ a }}</p>
            {% empty %}
            <p>Nothing yet. Get to puzzling!</p>
            {% endfor %}
        </div>
    </div>
</div>
        

</section>
{% endblock %}

{% block extra_scripts %}
<script type="text/javascript">
$(function() {

    var update_time_remaining = function() {
        // TODO
    };

    var status_hash = '',
        check_for_updates = function() {
            $.ajax({
                // TODO
                success: function(new_status) {
                    if (status_hash) {
                        if (status_hash != new_status) {
                            status_update();
                        }
                    } else {
                        status_hash = new_status;
                    }
                }
            })
    }

    var status_update = function() {
        // TODO: alert message? or jQuery.load in stuff?
    }

});
</script>
{% endblock %}